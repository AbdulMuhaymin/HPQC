<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>betaFit: Modules/llsqf.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">betaFit
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_f2541a3b18981391fa76fac5599e978a.html">Modules</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">llsqf.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a453597d4db6d98f8c8c7546a2ce0f357"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="llsqf_8f.html#a453597d4db6d98f8c8c7546a2ce0f357">llsqf</a> (NDATA, NPARM, MXDATA, MXPARM, YO, YU, DYDP, YD, PV, PU, PS, CM, DSE)</td></tr>
<tr class="memdesc:a453597d4db6d98f8c8c7546a2ce0f357"><td class="mdescLeft">&#160;</td><td class="mdescRight">Program for performing linear least squares fits using orthogonal decomposition of the Design (partial derivative) matrix. It is designed for the data sets of modest size where it is convenient to generate and store the complete partial derivative matrix prior to calling LLSQF. If this is not the case, subroutine version LLSQFVL, which generates this partial derivative array one row at a time through calls to a user-supplied subroutine, should be used.  <a href="llsqf_8f.html#a453597d4db6d98f8c8c7546a2ce0f357">More...</a><br /></td></tr>
<tr class="separator:a453597d4db6d98f8c8c7546a2ce0f357"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d5599dc18518f8420c2741f77477588"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="llsqf_8f.html#a2d5599dc18518f8420c2741f77477588">qqrod</a> (N, NR, NC, A, R, F, B, GC, GS)</td></tr>
<tr class="memdesc:a2d5599dc18518f8420c2741f77477588"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs orthogonal decomposition of the linear least-squares equation:  <a href="llsqf_8f.html#a2d5599dc18518f8420c2741f77477588">More...</a><br /></td></tr>
<tr class="separator:a2d5599dc18518f8420c2741f77477588"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a453597d4db6d98f8c8c7546a2ce0f357"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a453597d4db6d98f8c8c7546a2ce0f357">&#9670;&nbsp;</a></span>llsqf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine llsqf </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NDATA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NPARM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>MXDATA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>MXPARM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(ndata)&#160;</td>
          <td class="paramname"><em>YO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(ndata)&#160;</td>
          <td class="paramname"><em>YU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(mxdata,nparm)&#160;</td>
          <td class="paramname"><em>DYDP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(ndata)&#160;</td>
          <td class="paramname"><em>YD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(nparm)&#160;</td>
          <td class="paramname"><em>PV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(nparm)&#160;</td>
          <td class="paramname"><em>PU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(nparm)&#160;</td>
          <td class="paramname"><em>PS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(mxparm,mxparm)&#160;</td>
          <td class="paramname"><em>CM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>DSE</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Program for performing linear least squares fits using orthogonal decomposition of the Design (partial derivative) matrix. It is designed for the data sets of modest size where it is convenient to generate and store the complete partial derivative matrix prior to calling LLSQF. If this is not the case, subroutine version LLSQFVL, which generates this partial derivative array one row at a time through calls to a user-supplied subroutine, should be used. </p>
<h2><a class="anchor" id="autotoc_md3"></a>
On Entry:</h2>
<p>\( NDATA \) is the number of data to be fitted ( \( \leq MXDATA \)).</p>
<p>\( NPARM \) is the number of parameters to be varied ( \( \leq MXPARM \)). </p><pre class="fragment"> If NPARM is &lt;= 0, assume YD(i) = YO(i) and calculate the (RMS dimensionless deviation) = DSE from them &amp; YU(i).
</pre><p> \( MXDATA \) &amp; \( MXPARM \) are array dimension parameters (see below). Internal array sizes currently assume MXPARM \( \leq \) 60.</p>
<p>\( YO(i) \) are the \( NDATA \) 'observed' data; for iterative non-linear fits these are: \( [Y(obs,i) - Y(trial,i)] \).</p>
<p>\( YU(i) \) are the uncertainties in these \( YO(i) \) values.</p>
<p>\( DYDP(i,j) \) is the partial derivative array \( \frac{dYO(i)}{dPV(j)} \).</p>
<h2><a class="anchor" id="autotoc_md4"></a>
On Exit:</h2>
<p>\( PV(j) \) are the fitted parameter values; for iterative non-linear fits these are the parameter changes.</p>
<p>\( PU(j) \) are 95% confidence limit uncertainties in the \( PV(j) \)'s.</p>
<p>\( PS(j) \) are 'parameter sensitivities' for the \( PV(j) \)'s, defined such that the RMS displacement of predicted data due to rounding off parameter-j by \( PS(j) \) is \( \leq \frac{DSE}{10NPARM} \).</p>
<p>\( DSE \) is predicted (dimensionless) standard error of the fit.</p>
<p>\( YD(i) \) is the array of differences \( [YO(i) - Ycalc(i)] \). \( CM(j,k) \) is the correlation matrix obtained by normalizing variance/covariance matrix: </p><p class="formulaDsp">
\[ CM(j,k) = \frac{CM(j,k)}{\sqrt{CM(j,j)*CM(k,k)}} \]
</p>
<p> The squared 95% confidence limit uncertainty in a property \( F({PV(j)}) \) defined in terms of the fitted parameters \( {PV(j)} \) is (where the L.H.S. involves \( [row]*[matrix]*[column] \) multiplication): </p><p class="formulaDsp">
\[ [D(F)]^2 = [PU(1)*\frac{dF}{dPV}(1), PU(2)*\frac{dF}{dPV}(2), ...]*[CM(j,k)]*[PU(2)*\frac{dF}{dPV}(1), PU(2)*\frac{dF}{dPV}(2), ...] \]
</p>
<p> Externally dimension: \( YO \), \( YU \) and \( YD \geq NDATA \) (say as \( MXDATA \)), \( PV \), \( PU \) and \( PS \geq NPARM \) (say as \( MXPARM \)), \( DYDP \) with column length \( MXDATA \) and row length \( \geq NPARM CM \) as a square matrix with column &amp; row length \( MXPARM \). </p>

</div>
</div>
<a id="a2d5599dc18518f8420c2741f77477588"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d5599dc18518f8420c2741f77477588">&#9670;&nbsp;</a></span>qqrod()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine qqrod </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(nr,nc)&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(n)&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(nr)&#160;</td>
          <td class="paramname"><em>F</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(n)&#160;</td>
          <td class="paramname"><em>GC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(n)&#160;</td>
          <td class="paramname"><em>GS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs orthogonal decomposition of the linear least-squares equation: </p>
<p class="formulaDsp">
\[ (J*X = F) \rightarrow (A*X = B(Transpose)*F) \]
</p>
<p> where \( J \) is the Jacobian in which the first \( N \) rows and columns are transformed to the upper triangular matrix \( A (J = B*A) \), X is the independent variable vector, and F is the dependent variable vector. The transformation is applied to one row of the Jacobian matrix at a time.</p>
<h2><a class="anchor" id="autotoc_md5"></a>
Parameters:</h2>
<p>\( N \) (Integer) is the dimension of \( A \) to be transformed.</p>
<p>\( NR \) (Integer) is the row dimension of a declared in calling program.</p>
<p>\( NC \) (Integer) is the column dimension of \( F \) declared in calling program.</p>
<p>\( A \) (Real*8 array of dimensions \( \geq N*N \)) upper triangular transformation matrix.</p>
<p>\( R \) (Real*8 linear array of dimension \( \geq N \)) row of Jacobian to be added.</p>
<p>\( F \) (Real*8 linear array \( \geq \) to the row dimension of the Jacobian) transformed dependent variable matrix.</p>
<p>\( B \) (Real*8) value of \( F \) that corresponds to the added Jacobian row.</p>
<p>\( GC \) (Real*8 linear array \( \geq N \)) givens cosine transformations.</p>
<p>\( GS \) (Real*8 linear array \( \geq N \)) givens sine transformations. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
